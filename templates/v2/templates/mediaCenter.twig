{% extends '_layout' %}

{% block content %}

{% set filterCat      = craft.app.request.getQueryParam('filter') %}
{% set headerTitle    = entry.mediaPress_headerTitle %}
{% set pageTitle      = entry.mediaPress_pageTitle %}
{% set pageCopy       = entry.mediaPress_copy %}

{% set bannerTitle    = entry.banner_title %}
{% set bannerSubtitle = entry.banner_subtitle %}
{% set bannerCta      = entry.banner_cta %}

<!-- Latest News 2 -->
  <section class="headTitle bgColor-darkviolet">
    <div class="headTitle-content">
      <div class="headTitle-breadcrumb"><a href="{{ siteUrl }}">HOME</a> // <a href="{{ entry.url }}">NEWS & STORIES</a></div>
      <div class="headTitle-title">
        <h3 class="separator left-aligned"><span>{{ headerTitle }}</span></h3>
      </div>
    </div>
  </section>
<!-- Latest News -->

  <div class="mediaContacts">
    
    <div class="mediaContacts-header">
      <div class="mediaContacts-header-title">{{ pageTitle }}</div>
      <div class="mediaContacts-header-copy">{{ pageCopy }}</div>
      <div class="mediaContacts-header-filter">Filter By:</div>
          <div class="mediaContacts-header-links">
            <a href="{{ entry.url }}/"  class="button-sand {% if filterCat  == '' %}active{% endif %}">View all</a>
            <a href="{{ entry.url }}/?filter=pressReleases" class="button-sand {% if filterCat  == 'pressReleases' %}active{% endif %}">View all press releases</a>
            <a href="{{ entry.url }}/?filter=news"  class="button-sand {% if filterCat  == 'news' %}active{% endif %}">View all media coverage</a>
          </div>   
    </div>



{% set myEntry = craft.entries().section('projects') %}

{% set t_copy = 0 %}
{% set t_singleImage = 0 %}
{% set t_copyImage = 0 %}
{% set t_slideshow = 0 %}
{% set t_largeBlockQuote = 0 %}
{% set t_infoModule = 0 %}
{% set t_video = 0 %}
{% set t_chart = 0 %}
{% set t_audio = 0 %}
{% set t_anchor = 0 %}
{% set t_map = 0 %}
{% set t_code = 0 %}
{% set t_test = 0 %}

{% for rr in myEntry %}

  {% for tt in rr.article %}
    {% switch tt.type.handle %}
       {% case 'copy' %} 
         {% set t_copy = t_copy + 1 %}
       {% case 'singleImage' %} 
         {% set t_singleImage = t_singleImage + 1 %}
                   <a href="{{rr.url}}">{{ rr.title }}</a> <br>    
       {% case 'copyImage' %} 
         {% set t_copyImage = t_copyImage + 1 %}
       {% case 'slideshow' %} 
         {% set t_slideshow = t_slideshow + 1 %}    
       {% case 'largeBlockQuote' %} 
         {% set t_largeBlockQuote = t_largeBlockQuote + 1 %}     
       {% case 'infoModule' %} 
         {% set t_infoModule = t_infoModule + 1 %}   
       {% case 'video' %} 
         {% set t_video = t_video + 1 %}     
 
       {% case 'chart' %} 
         {% set t_chart = t_chart + 1 %}        
       {% case 'audio' %} 
         {% set t_audio = t_audio + 1 %}   
       {% case 'anchor' %} 
         {% set t_anchor = t_anchor + 1 %}      
       {% case 'map' %} 
         {% set t_map = t_map + 1 %}    
       {% case 'code' %} 
         {% set t_code = t_code + 1 %} 
       {% case 'test' %} 
         {% set t_test = t_test + 1 %}                                                                                            
       {% endswitch %}
  {% endfor %}
{% endfor %}

       Copy -  {{ t_copy }} <br>
       Single Image -  {{ t_singleImage }} <br>
       Copy + Image - {{ t_copyImage }} <br>
       Slideshow - {{ t_slideshow }} <br>
       Large Block Quote - {{ t_largeBlockQuote }} <br>
       Info Module -{{ t_infoModule }} <br>
       Video - {{ t_video }} <br>
       Chart - {{ t_chart }} <br>
       Audio - {{ t_audio }} <br>
       Anchor - {{ t_anchor }} <br>
       Map - {{ t_map }} <br>
       Code - {{ t_code }} <br>
       Test - {{ t_test }} <br>
    <div class="mediaContacts-items">

      {% switch filterCat %}
         {% case 'news' %}
           {% set totalEntries = craft.entries.section('news').limit(10).count() %}
           {% paginate craft.entries.section('news').limit(10) as pageInfo, pageEntries %}
         {% case 'pressReleases'%}
           {% set totalEntries = craft.entries.section('pressReleases').limit(10).count() %}
           {% paginate craft.entries.section('pressReleases').limit(10) as pageInfo, pageEntries %}
         {% default %}
           {% set totalEntries = craft.entries.section(['pressReleases','news']).limit(10).count() %}
           {% paginate craft.entries.section(['pressReleases','news']).limit(10) as pageInfo, pageEntries %}
      {% endswitch %}

      {% for entry in pageEntries %}

        {% if loop.index == 8 %}
          <!-- Banner Type 4 -->
          <section class="bannerType4">
            <div class="bannerType4-content">
              <h3 class="bannerType4-title">{{ bannerTitle }}</h3>
              <div class="bannerType4-text">
              <p>{{ bannerSubtitle }}</p>
              </div>
              <a href="{{ bannerCta.getUrl() }}" class="button orange arrow"><span>{{  bannerCta.customText }}</span></a>
            </div>
          </section>
          <!-- Banner Type 4 -->
        {% endif %}

        <div class="mediaContacts-item">
          <div class="mediaContacts-item-content">

            <div class="mediaContacts-item-content-left">
              <div class="mediaContacts-item-content-left-tag">
              {% if entry.type.name == "News" %}
                Media Coverage
              {% else %}
              {{ entry.type.name | title | upper }}
              {% endif %}
              
              </div>
            </div>

            <div class="mediaContacts-item-content-right">
              <div class="mediaContacts-item-content-right-title">
              
                {% if entry.type == 'pressRelease' %}
                  <a href="{{ entry.url }}">{{ entry.title }}</a>
                {% elseif  entry.type == 'news' %}
                  <a href="{{ entry.linkUrl }}" target="_blank">{{ entry.title }}</a>
                {% endif %}
              </div>
              <div class="mediaContacts-item-content-right-date">{{ entry.postDate | date("M d, Y") }}</div>
            </div>

          </div>
        </div>
      {% endfor %}


        <div class="mediaContacts-paginate">
          
          {% if pageInfo.prevUrl %}
            <a href="{{ pageInfo.prevUrl }}" class="mediaContacts-paginate-item-prev">Prev</a>
          {% else %}
            <a href="{{ pageInfo.firstUrl }}" class="mediaContacts-paginate-item-prev">Prev</a>
          {% endif %}

          {% for page, url in pageInfo.getPrevUrls(4) %}
            <a href="{{ url }}" class="mediaContacts-paginate-item">{{ page }}</a>
          {% endfor %}

          <span class="mediaContacts-paginate-item--current">{{ pageInfo.currentPage }}</span>
          
          {% for page, url in pageInfo.getNextUrls(4) %}
            <a href="{{ url }}" class="mediaContacts-paginate-item">{{ page }}</a>
          {% endfor %}

          {% if pageInfo.nextUrl %}<a href="{{ pageInfo.nextUrl }}" class="mediaContacts-paginate-item-next">Next</a>{% endif %}
        </div>
        <div class="mediaContacts-paginate-counter"> {{ pageInfo.currentPage * 10 - 9 }}-{{ pageInfo.currentPage * 10 }} of {{ totalEntries }} results </div>
    </div>
  </div>

{% endblock %}
