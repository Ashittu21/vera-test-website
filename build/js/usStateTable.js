"use strict";function UsStateTable(_ref){var selector=_ref.selector,cmsData=_ref.cmsData,csvUrl=_ref.csvUrl;d3.csv(csvUrl,function(error,data){if(error){return null;}update();window.addEventListener("resize",function(){update();});function update(){var columns=determineColumns();var container=d3.select(selector);container.html(null);var chunked=_.chunk(data,Math.ceil(data.length/columns));chunked.forEach(function(data){return makeTable(container,data);});}function determineColumns(){if(!window||!window.matchMedia){return 1;}if(window.matchMedia("(min-width: 650px)").matches){return 2;}return 1;}});function makeTable(container,data){var table=container.append("table").attr("class","table__topx").attr("style","width: auto;").append("tbody");var th=table.append("tr");th.append("th").text("State");th.append("th").text("PDF");th.append("th").text("Total Incarceration");var rows=table.selectAll(".row").data(data).enter().append("tr").attr("class","row");rows.append("td").append("div").attr("style","display: flex; justify-content: space-between").html(function(d){var html="";var stateData=cmsData[d["state"]];html+=stateData?"<a href=\""+stateData.url+"\">"+d["state_name"]+"</a>":d["state"];return html;});var pdfs=rows.append("td").attr("style","text-align: center").html(function(d){var stateData=cmsData[d["state"]];if(stateData){return"\n            <a class=\"download\" href=\""+stateData.pdfUrl+"\" \n              onclick=\"ga('send','pageview','"+stateData.pdfUrl+"')\"\n              target=\"_blank\" \n              rel=\"noopener noreferer\">\n              <span class=\"icon-doc\"></span>\n            </a>\n          ";}});rows.append("td").text(function(d){return(+d["total_state_incarceration_2015"]).toLocaleString(undefined,{maximumFractionDigits:0});});}}