'use strict';(function(){//closure
window.addEventListener("load",function(){init();});var DEFAULT_SLIDE_TIME=4000,LONG_SLIDE_TIME=5500;var slideTime=DEFAULT_SLIDE_TIME;var init=function init(){var containers=document.querySelectorAll('.timed-slideshow');[].forEach.call(containers,function(container){new initSlideshow(container);});};var initSlideshow=function initSlideshow(container){var fadeTl=void 0;var scrollDownOnComplete=false,resetOnScrollTo=true;var $scroller=$('html,body'),slides=container.querySelectorAll('.timed-slideshow-item'),slideCount=slides.length,options=JSON.parse(container.dataset.options);var currentSlideIndex=void 0,currentSlide=void 0;var slideTimer=void 0;if(!slideCount){console.log("No slides");return;}if(options.asHero){scrollDownOnComplete=true,resetOnScrollTo=true;}if(resetOnScrollTo){var sm=new ScrollMagic.Controller();new ScrollMagic.Scene({triggerElement:container,triggerHook:0.5,duration:container.getBoundingClientRect().height}).on('enter',function(event){startOver();}).addTo(sm);}var continueShow=true;var nextSlide=function nextSlide(){currentSlideIndex++;if(currentSlideIndex>=slideCount){currentSlideIndex=0;if(scrollDownOnComplete){var rect=container.getBoundingClientRect(),scrollTo=+rect.height+$(container).offset().top;if($scroller.scrollTop()<rect.height){$scroller.animate({scrollTop:scrollTo});}continueShow=false;}}if(continueShow){currentSlide=changeSlide(currentSlide,slides[currentSlideIndex]);}};var startOver=function startOver(){if(slideTimer){clearTimeout(slideTimer);}if(fadeTl){fadeTl.pause().clear();}currentSlideIndex=-1;currentSlide=null;continueShow=true;TweenLite.set(slides,{autoAlpha:0});var videos=container.querySelectorAll('video');[].forEach.call(videos,function(video){video.pause();});nextSlide();};var initSlides=function initSlides(slides){//init videos
[].filter.call(slides,function(slide){var video=slide.querySelector('video');if(video){var onEnd=function onEnd(){video.pause();nextSlide();};video.addEventListener('ended',onEnd);}});};var changeSlide=function changeSlide(prev,next){var video=next.querySelector('video');var copy=next.querySelector('.heading');if(copy!==null){var copyLength=copy.innerHTML.length;if(copyLength>150){slideTime=LONG_SLIDE_TIME;}}fadeTl=new TimelineLite({paused:true,onComplete:video===null?function(){slideTimer=setTimeout(function(){nextSlide();},slideTime);}:null});if(prev){fadeTl.to(prev,1,{autoAlpha:0});}fadeTl.to(next,1,{autoAlpha:1});if(video){video.currentTime=0;video.play();}fadeTl.play();return next;};initSlides(slides);startOver();};//closure
})();