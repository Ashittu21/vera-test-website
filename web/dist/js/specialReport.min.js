/**
 * @project        vera
 * @author         Dylan Viola, Hyperakt
 * @build          Mon, Feb 14, 2022 8:25 PM ET
 * @copyright      Copyright (c) 2022, 
 *
 */
"use strict";!function(f){var g=f.VERA||{};f.VERA=g,$(function(){g.sm=g.sm||new ScrollMagic.Controller,g.article=new e});var e=function(){this.headers=$(".featured-banner.editorial:not(.show-on-print)"),this.headers.length&&this.headers.each(function(){!function(t,i){i=i||!1;var e,a=$(t),r=a.find(".line"),n=a.find(".title"),o=a.find(".subtitle"),l=a.find(".overview"),s=a.find(".screen"),h={opacity:1,webkitFilter:"blur(0px)",filter:"blur(0px)",x:0},h=new TimelineMax({paused:i}).to(n,1,h).to(o,1,h,0);{var c;i?0<$(f).scrollTop()?h.time(1):h.play():c=new ScrollMagic.Scene({triggerElement:t,triggerHook:.5}).setTween(h).addTo(g.sm)}i&&(d(),f.addEventListener("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){c.destroy(!0),d()},100)}));function d(){var e;r.css({height:""}),i&&(e=(new TimelineMax).to(n,1,{opacity:0,webkitFilter:"blur(5px)",filter:"blur(5px)",delay:1}).to(o,1,{opacity:0,webkitFilter:"blur(5px)",filter:"blur(5px)",delay:1},0).to(r,.5,{height:0}).to(r,.2,{opacity:0,delay:.3}).to(s,.25,{opacity:.5}).to(l,.25,{opacity:1,delay:.5})),c=new ScrollMagic.Scene({triggerElement:t,offset:-$(".header").height(),triggerHook:0,duration:"100%"}).setPin(t).setTween(e).addTo(g.sm),a.find("video").each(function(){this.play()})}a.find("video").on("canplaythrough",function(){this.play()})}(this,!!$(this).filter(".editorialIntroduction").length)});var e,a=$(".dropdown"),t=$(".dropdown-outer"),r=t.find(".dropdown-active"),h=$(".header__menu-radial"),i=$(".header-tiles");function n(e){h.find(".current-chapter").html(e=e<1?1:e)}function c(e,t){e=$(e).height();return Math.floor(100*(t/e))}function o(e,t){t=t||!1,a&&(a.find(".anchor-link.active").removeClass("active"),e.addClass("active"),r.text(e.data("chapter")));var i,e=e.attr("href");void 0!==e&&(i=e.replace("#",""));try{history.pushState||(location.hash=e)}catch(e){console.log(e)}$(".campaignSlide").length&&$(".touch").length,!t||$(".campaignSlide").length&&!$(".touch").length||$("html,body").animate({scrollTop:$("#"+i).offset().top})}h.length&&$("article[data-anchor-link]").each(function(e,t){$(t).hasClass("active")&&($(t).hasClass("js-hide-radial-nav")?h.addClass("is-intro"):h.removeClass("is-intro"),n(e))}),f.location.hash&&(a.find(".anchor-link.active").removeClass("active"),(e=$('.anchor-link[href="'+f.location.hash+'"]')).addClass("active"),r.text(e.data("chapter"))),$(".article p img").length&&("left"===$(".article p img").css("float")&&$(".article p img").addClass("c-figure--left"),"right"===$(".article p img").css("float")&&$(".article p img").addClass("c-figure--right")),$(".anchor-link").on("click",function(e){e.preventDefault(),o($(this),!0),t.removeClass("open"),i.removeClass("mainnav-open")}),$(".share-overlay .icon-print").on("click",function(e){e.preventDefault(),f.print()}),$(".campaignSlide").length&&!$(".touch").length||($(".anchor--chapter").each(function(){var e=$(this),t=$('.anchor-link[href="#'+e.attr("id")+'"]'),i=$('.anchor-link[href="#'+e.prevAll(".anchor--chapter").first().attr("id")+'"]');new ScrollMagic.Scene({triggerElement:this,triggerHook:.5}).on("enter",function(){o(t)}).on("leave",function(){o(i)}).addTo(g.sm)}),f.addEventListener("scroll",_.throttle(function(){var o,l,s,e,t;h.length&&(o=$("article[data-anchor-link]"),t=o.filter(".js-hide-radial-nav"),l=o.first(),s=1,e=t.length?f.pageYOffset-t.outerHeight()+$("header").outerHeight()+$("footer").outerHeight():f.pageYOffset+$("header").outerHeight()+$("footer").outerHeight(),h.removeClass("is-intro"),o.each(function(e,t){var i=$(t).offset().top,a=i+$(t).outerHeight(),r=$(f).scrollTop(),n=r+$(f).height();r<a&&i<n&&(s=o.hasClass("js-hide-radial-nav")?e:e+1,l=t,$(l).hasClass("js-hide-radial-nav")?h.addClass("is-intro"):h.removeClass("is-intro"))}),t=o.not(".js-hide-radial-nav"),2===s?e-=$(t[0]).outerHeight():3===s?e=e-$(t[0]).outerHeight()-$(t[1]).outerHeight():4===s?e=e-$(t[0]).outerHeight()-$(t[1]).outerHeight()-$(t[2]).outerHeight():5===s&&(e=e-$(t[0]).outerHeight()-$(t[1]).outerHeight()-$(t[2]).outerHeight()-$(t[3]).outerHeight()),f.innerWidth<700&&("introduction"==$(l).prev().attr("id")?h.addClass("is-intro"):h.removeClass("is-intro"),o.hasClass("special-reports-chapter")&&--s),n(s),t=$(".circle"),0<c(l,e)&&t.attr("stroke-dasharray",c(l,e)+", 100"))},500)))}}(window);