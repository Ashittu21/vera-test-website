/**
 * @project        vera
 * @author         Dylan Viola, Hyperakt
 * @build          Mon, Feb 14, 2022 8:25 PM ET
 * @copyright      Copyright (c) 2022, 
 *
 */
"use strict";!function(){var t=window.VERA||{};function a(){$("[data-percentage-pie]:not(.percentage-pie-initialized)").each(e),$("[data-ratio]:not(.ratio-initlialized)").each(r),$("[data-time]:not(.time-initlialized)").each(n)}function e(){var t=$(this),a=100,e=a,a=JSON.parse(t.attr("data-percentage-pie"));t.addClass("percentage-pie-initialized"),a?(t=[a.value,100-a.value],a=d3.pie()(t),t=d3.arc().innerRadius(32).outerRadius(40),a.pop(),(a=d3.select(this).append("svg").attr("viewBox","0 0 100 "+e).selectAll("g").data(a).enter().append("g")).append("path").attr("class","bg-arc").attr("d",t({startAngle:0,endAngle:2*Math.PI})).attr("x",50).attr("y",50).attr("transform","translate(50 50)"),a.append("path").attr("class","data-arc").attr("d",t).attr("transform","translate(50 50)"),a.append("text").text(function(t){return t.value+"%"}).attr("x",50).attr("y",50).attr("class","viz-text filled"),b(this)):console.warn("invalid fact params",this)}function r(){var t,e,r,n,a=$(this),i=JSON.parse(a.attr("data-ratio"));a.addClass("ratio-initialized"),i&&((t=[]).length=i.value.consequent,a=Math.ceil(i.value.consequent/10)*(e=10<=t.length?10:100/t.length),n=e/2-2*(r=.1*e),d3.select(this).append("svg").attr("viewBox","0 0 100 "+a).append("g").selectAll(".piece").data(t).enter().append("circle").attr("r",n).attr("cx",function(t,a){return a%10*e+r+n}).attr("cy",function(t,a){return Math.floor(a/10)*e+r+n}).attr("class",function(t,a){return"piece "+(a<i.value.antecedant?"filled":"")}),b(this))}function n(){var t=$(this),a=JSON.parse(t.attr("data-time")),e="days"===a.unit?"calendar":"clock",t=$(this),r=d3.select(this).append("svg");switch(e){case"calendar":var n=+a.value,i=Math.ceil(n/30),c=Math.max(1,Math.min(7,Math.floor(Math.log(2.72)*i))),l=Math.ceil(i/c),s=(w=100)/c*(5/7)*l,d=w/c,o=.05*d,p=5/7*d,u=.05*p,h=d-2*o,l=p-2*u,f=h/7,v=.05*f,g=l/5,M=.05*g;r.attr("viewBox","0 0 "+w+" "+s);for(var i=[],x=n;0<x;)i.push(30<=x?30:x),x-=30;n=r.selectAll(".calendar").data(i).enter().append("g").attr("transform",function(t,a){return"translate("+(a%c*d+o)+" "+(Math.floor(a/c)*p+u)+")"});n.append("rect").attr("class","calendar-back").attr("width",h).attr("height",l);var m=[];m.length=30,n.each(function(t,a){var e=t;d3.select(this).selectAll(".day-cell").data(m).enter().append("rect").attr("class",function(t,a){return"day-cell"+(a<e?" filled":"")}).attr("width",f-2*v).attr("height",g-2*M).attr("x",function(t,a){return a%7*f+v}).attr("y",function(t,a){return g*Math.floor(a/7)+M})});break;case"clock":var w,s=w=100,A=.45*w;r.attr("viewBox","0 0 "+w+" "+s);l=d3.arc().innerRadius(0).outerRadius(A).startAngle(0),n="hours"==a.unit?"12":"60",s=r.append("g").attr("transform","translate("+w/2+" "+s/2+")");s.append("circle").attr("class","clock-back").attr("r",A).attr("cx",0).attr("cy",0),s.append("path").attr("class","time-amount filled").attr("d",l({endAngle:a.value/n*Math.PI*2}));var y=[];y.length=12,s.append("g").attr("class","markings").selectAll("circle").data(y).enter().append("circle").attr("cx",function(t,a){return Math.cos(2*Math.PI*(a/y.length))*A*.9}).attr("cy",function(t,a){return Math.sin(2*Math.PI*(a/y.length))*A*.9}).attr("r",A/40);break;default:return}b(this)}t.initFacts=a,window.VERA=t,$(function(){a()});var i=new Event("factloaded",{bubbles:!0});function b(t){t.dispatchEvent(i)}}();