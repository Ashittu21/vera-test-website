(this["webpackJsonppolice-budgets"]=this["webpackJsonppolice-budgets"]||[]).push([[0],{12:function(e,t,n){e.exports=n.p+"static/media/Consolidated_72PoliceDepartments.21ec9f08.csv"},15:function(e,t,n){e.exports=n.p+"static/media/carrot.f3e14036.svg"},19:function(e,t,n){e.exports=n(36)},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){},27:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),u=n.n(c),l=(n(24),n(2)),i=(n(25),n(12)),o=n.n(i),s=n(38),m=n(3),d=(n(26),n(17)),f=(n(27),Object(a.createContext)(1)),v=function(e){return r.a.createElement(f.Consumer,null,(function(t){return r.a.createElement(f.Provider,{value:t+1},e.children)}))},E=function(e){return r.a.createElement(f.Consumer,null,(function(t){var n="h"+Math.min(t,6);return r.a.createElement(n,e)}))},g=n(6),y=n(13),b=function(e,t){switch(t.type){case"setValue":return Object(m.a)(Object(m.a)({},e),{},{changes:Object(m.a)(Object(m.a)({},e.changes),{},Object(g.a)({},t.key,t.value))});default:return e}},h={changes:{}},p=function(e){var t=Object(y.useStorageReducer)(localStorage,"".concat(e," Police Budget"),b,h),n=Object(l.a)(t,2),a=n[0],r=n[1];return{state:a,setValue:function(e){return function(t){r({type:"setValue",key:e,value:t})}}}},O=n(18),j=n(15),k=n.n(j),w=function(){return r.a.createElement(O.a,{src:k.a})},x=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),P=function e(t){var n=t.data,c=t.state,u=t.setValue,l=Object(a.useContext)(f),i=Object.keys(n),o=c.changes;return 1!==i.length||Array.isArray(n[i[0]])?r.a.createElement(v,null,r.a.createElement("div",{style:{marginLeft:"".concat(l>1?2:0,"rem")}},i.map((function(t){if(Array.isArray(n[t]))return r.a.createElement("div",{key:t,className:"PoliceBudget-lineitem PoliceBudget-lineitem--final"},r.a.createElement(E,null,t),r.a.createElement(A,{value:o[t],onChange:u(n[t][0].uid)}),r.a.createElement("div",null,x.format(n[t][0].total)));var a=function e(t){return Array.isArray(t)?t[0].uid:e(t[Object.keys(t)[0]])}(n[t]),l=C(n[t]),s=N(n[t]),m=N(n[t],o),d=n[i[i.indexOf(t)+1]]&&C(n[i[i.indexOf(t)+1]]);return r.a.createElement(B,{key:t,title:t,nextLevel:l,nextIsParent:d,value:o[a],setValue:u(a),before:s,after:m},l&&r.a.createElement("div",null,r.a.createElement(e,{data:l,state:c,setValue:u})))})))):r.a.createElement(e,{data:n[i[0]],state:c,setValue:u})},B=function(e){var t=e.nextLevel,n=e.nextIsParent,c=e.title,u=e.value,i=e.setValue,o=e.before,s=e.after,m=e.children,d=Object(a.useState)(!0),f=Object(l.a)(d,2),v=f[0],g=f[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"PoliceBudget-lineitem ".concat(t?"":"PoliceBudget-lineitem--final"," ").concat(n?"PoliceBudget-lineitem--last":"")},t?r.a.createElement("button",{className:"PoliceBudget-lineitem-toggle ".concat(v?"is-open":""),onClick:function(){return g(!v)}},r.a.createElement(w,null),r.a.createElement(E,null,c)):r.a.createElement(E,null,c),r.a.createElement("div",null,!t&&r.a.createElement(A,{value:u,onChange:i})),r.a.createElement("div",null,x.format(o)),r.a.createElement("div",null,x.format(s))),v&&m)},A=function(e){var t=e.value,n=e.onChange;return r.a.createElement("input",{type:"number",value:t||0,increment:1,max:100,min:-100,onChange:function(e){return n(+e.target.value)}})};function C(e){if(Array.isArray(e))return null;var t=Object.keys(e);return 1===t.length?C(e[t[0]]):e}function N(e,t){return Object.values(e).reduce((function(e,n){return e+(Array.isArray(n)?n.reduce((function(e,n){var a=t&&t[n.uid]?1-t[n.uid]/100:1;return e+ +n.total*a}),0):N(n,t))}),0)}var V=function(e){var t=e.city,n=e.data,a=p(t),c=a.state,u=a.setValue,l=N(n),i=N(n,c.changes);return r.a.createElement("div",{className:"PoliceBudget"},r.a.createElement("div",{className:"PoliceBudget-title"},r.a.createElement("h1",null,t)),r.a.createElement("div",{className:"PoliceBudget-lineitem PoliceBudget-header"},r.a.createElement("div",null,"Category"),r.a.createElement("div",null,"% Reduction"),r.a.createElement("div",null,"Before"),r.a.createElement("div",null,"After")),r.a.createElement("div",{className:"PoliceBudget-budget"},r.a.createElement(P,{data:n,state:c,setValue:u})),r.a.createElement("div",{className:"PoliceBudget-lineitem PoliceBudget-total"},r.a.createElement("div",null,"Total"),r.a.createElement("div",null),r.a.createElement("div",null,x.format(l)),r.a.createElement("div",null,x.format(i))))},S=function(e){var t=e.data,n=L(t),c=Object.keys(n).map((function(e){return{value:e,label:e}})),u=Object(a.useState)(c[0].value),i=Object(l.a)(u,2),o=i[0],s=i[1];return Object(a.useEffect)((function(){var e=c.map((function(e){return e.value})),t=function(t){"ArrowUp"===t.key?function(){var t=e.indexOf(o),n=c[t+1]?c[t+1]:c[0];s(n.value)}():"ArrowDown"===t.key&&function(){var t=e.indexOf(o),n=c[t-1]?c[t-1]:c[e.length-1];s(n.value)}()};return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}}),[o,c]),r.a.createElement("div",{className:"CitySwitcher"},r.a.createElement(d.a,{options:c,value:c.find((function(e){return e.value===o})),onChange:function(e){s(e.value)}}),r.a.createElement(V,{city:o,data:n[o]}))},L=function(e){var t=e.map((function(e){return Object(m.a)({uid:"".concat(e.department,"-").concat(e.expensecat,"-").concat(e.subdep,"-").concat(e.expensedescrip,"-").concat(e.personneltype)},e)})).reduce((function(e,t){return e[t.citystate]||(e[t.citystate]=[]),e[t.citystate].push(t),e}),{});return I(t)},I=function(e){return Object.keys(e).reduce((function(t,n){return t[n]=D("department",e[n]),Object.keys(t[n]).forEach((function(e){t[n][e]=D("expensecat",t[n][e]),Object.keys(t[n][e]).forEach((function(a){t[n][e][a]=D("subdep",t[n][e][a]),Object.keys(t[n][e][a]).forEach((function(r){t[n][e][a][r]=D("expensedescrip",t[n][e][a][r]),Object.keys(t[n][e][a][r]).forEach((function(c){t[n][e][a][r][c]=D("personneltype",t[n][e][a][r][c])}))}))}))})),t}),{})},D=function(e,t){return t.reduce((function(t,n){return t[n[e]]||(t[n[e]]=[]),t[n[e]].push(n),t}),{})},U=function(){var e=F(o.a);return e?r.a.createElement(S,{data:e}):r.a.createElement("div",null,"Loading")},F=function(e){var t=Object(a.useState)(),n=Object(l.a)(t,2),r=n[0],c=n[1];return Object(a.useEffect)((function(){fetch(e).then((function(e){return e.text()})).then((function(e){c(Object(s.a)(e))}))}),[c,e]),r};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(r.a.createElement(U,null),document.getElementById("PoliceBudgets")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.a27fd08e.chunk.js.map