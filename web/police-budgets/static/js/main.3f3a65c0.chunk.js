(this["webpackJsonppolice-budgets"]=this["webpackJsonppolice-budgets"]||[]).push([[0],{12:function(e,t,n){e.exports=n.p+"static/media/Consolidated_72PoliceDepartments.21ec9f08.csv"},16:function(e,t,n){e.exports=n(33)},21:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(11),u=n.n(c),i=(n(21),n(3)),o=(n(22),n(12)),l=n.n(o),s=n(35),f=n(2),m=(n(23),n(15)),d=(n(24),Object(a.createContext)(1)),v=function(e){return r.a.createElement(d.Consumer,null,(function(t){return r.a.createElement(d.Provider,{value:t+1},e.children)}))},y=function(e){return r.a.createElement(d.Consumer,null,(function(t){var n="h"+Math.min(t,6);return r.a.createElement(n,e)}))},E=n(6),h=n(13),p=function(e,t){switch(t.type){case"setValue":return Object(f.a)(Object(f.a)({},e),{},{changes:Object(f.a)(Object(f.a)({},e.changes),{},Object(E.a)({},t.key,t.value))});default:return e}},b={changes:{}},g=function(e){var t=Object(h.useStorageReducer)(localStorage,"".concat(e," Police Budget"),p,b),n=Object(i.a)(t,2),a=n[0],r=n[1];return{state:a,setValue:function(e){return function(t){r({type:"setValue",key:e,value:t})}}}},O=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),j=function e(t){var n=t.data,c=t.state,u=t.setValue,i=Object(a.useContext)(d),o=Object.keys(n),l=c.changes;return 1!==o.length||Array.isArray(n[o[0]])?r.a.createElement(v,null,r.a.createElement("div",{style:{marginLeft:"".concat(i,"rem")}},o.map((function(t){if(Array.isArray(n[t]))return r.a.createElement("div",{key:t,className:"PoliceBudget-lineitem"},r.a.createElement(y,null,t),r.a.createElement(k,{value:l[t],onChange:u(n[t][0].uid)}),r.a.createElement("div",null,O.format(n[t][0].total)));var a=function e(t){return Array.isArray(t)?t[0].uid:e(t[Object.keys(t)[0]])}(n[t]),i=function e(t){if(Array.isArray(t))return null;var n=Object.keys(t);if(1===n.length)return e(t[n[0]]);return t}(n[t]),o=x(n[t]),s=x(n[t],l);return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"PoliceBudget-lineitem"},r.a.createElement(y,null,t),r.a.createElement("div",null,!i&&r.a.createElement(k,{value:l[a],onChange:u(a)})),r.a.createElement("div",null,O.format(o)),r.a.createElement("div",null,O.format(s))),i&&r.a.createElement(e,{data:i,state:c,setValue:u}))})))):r.a.createElement(e,{data:n[o[0]],state:c,setValue:u})},k=function(e){var t=e.value,n=e.onChange;return r.a.createElement("input",{type:"number",value:t||0,increment:1,max:100,min:-100,onChange:function(e){return n(+e.target.value)}})};var w=function(e){var t=e.city,n=e.data,a=g(t),c=a.state,u=a.setValue,i=x(n),o=x(n,c.changes);return r.a.createElement("div",{className:"PoliceBudget"},r.a.createElement("div",{className:"PoliceBudget-lineitem"},r.a.createElement("h1",null,t),r.a.createElement("div",null),r.a.createElement("div",null,O.format(i)),r.a.createElement("div",null,O.format(o))),r.a.createElement(j,{data:n,state:c,setValue:u}))},x=function e(t,n){return Object.values(t).reduce((function(t,a){return t+(Array.isArray(a)?a.reduce((function(e,t){var a=n&&n[t.uid]?1-n[t.uid]/100:1;return e+ +t.total*a}),0):e(a,n))}),0)},A=function(e){var t=e.data,n=C(t),c=Object.keys(n).map((function(e){return{value:e,label:e}})),u=Object(a.useState)(c[0].value),o=Object(i.a)(u,2),l=o[0],s=o[1];return Object(a.useEffect)((function(){var e=c.map((function(e){return e.value})),t=function(t){"ArrowUp"===t.key?function(){var t=e.indexOf(l),n=c[t+1]?c[t+1]:c[0];s(n.value)}():"ArrowDown"===t.key&&function(){var t=e.indexOf(l),n=c[t-1]?c[t-1]:c[e.length-1];s(n.value)}()};return window.addEventListener("keydown",t),function(){return window.removeEventListener("keydown",t)}}),[l,c]),r.a.createElement("div",{className:"CitySwitcher"},r.a.createElement(m.a,{options:c,value:c.find((function(e){return e.value===l})),onChange:function(e){s(e.value)}}),r.a.createElement(w,{city:l,data:n[l]}))},C=function(e){var t=e.map((function(e){return Object(f.a)({uid:"".concat(e.department,"-").concat(e.expensecat,"-").concat(e.subdep,"-").concat(e.expensedescrip,"-").concat(e.personneltype)},e)})).reduce((function(e,t){return e[t.citystate]||(e[t.citystate]=[]),e[t.citystate].push(t),e}),{});return B(t)},B=function(e){return Object.keys(e).reduce((function(t,n){return t[n]=P("department",e[n]),Object.keys(t[n]).forEach((function(e){t[n][e]=P("expensecat",t[n][e]),Object.keys(t[n][e]).forEach((function(a){t[n][e][a]=P("subdep",t[n][e][a]),Object.keys(t[n][e][a]).forEach((function(r){t[n][e][a][r]=P("expensedescrip",t[n][e][a][r]),Object.keys(t[n][e][a][r]).forEach((function(c){t[n][e][a][r][c]=P("personneltype",t[n][e][a][r][c])}))}))}))})),t}),{})},P=function(e,t){return t.reduce((function(t,n){return t[n[e]]||(t[n[e]]=[]),t[n[e]].push(n),t}),{})},V=function(){var e=S(l.a);return e?(console.log(e),r.a.createElement(A,{data:e})):r.a.createElement("div",null,"Loading")},S=function(e){var t=Object(a.useState)(),n=Object(i.a)(t,2),r=n[0],c=n[1];return Object(a.useEffect)((function(){fetch(e).then((function(e){return e.text()})).then((function(e){c(Object(s.a)(e))}))}),[c,e]),r};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(r.a.createElement(V,null),document.getElementById("PoliceBudgets")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[16,1,2]]]);
//# sourceMappingURL=main.3f3a65c0.chunk.js.map